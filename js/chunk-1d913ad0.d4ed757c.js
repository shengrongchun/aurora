(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1d913ad0"],{"0bad":function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{visible:e.visible,"close-on-click-modal":!1,"before-close":function(){e.$emit("close")},title:e.title,width:"580px","append-to-body":""},on:{"update:visible":function(t){e.visible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[[e.sqlPresto?[a("el-form-item",{attrs:{label:"数据缓存",prop:"refreshable"}},[a("el-switch",{attrs:{"active-color":"#409EFF","inactive-color":"#aaa","active-value":1,"inactive-value":0},on:{change:function(t){return e.$refs.form.clearValidate("cacheRefreshCron")}},model:{value:e.form.refreshable,callback:function(t){e.$set(e.form,"refreshable",t)},expression:"form.refreshable"}})],1),e.form.refreshable?a("el-form-item",{attrs:{prop:e.form.refreshable?"cacheRefreshCron":"",label:"刷新频率"}},[a("CronTime",{model:{value:e.form.cacheRefreshCron,callback:function(t){e.$set(e.form,"cacheRefreshCron",t)},expression:"form.cacheRefreshCron"}})],1):e._e()]:a("span",[e._v("确定上线吗？")])]],2),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.$emit("close")}}},[e._v(e._s("online"===e.type||"line"===e.type?"暂不上线":"取消"))]),a("el-button",{attrs:{type:"primary"},on:{click:e.line}},[e._v(e._s("online"===e.type||"line"===e.type?"上线":"保存"))])],1)],1)},i=[],s=(a("7f7f"),a("b122")),n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"cron-time"},[a("span",[e._v("每")]),a("div",[a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.changeRange},model:{value:e.form.range,callback:function(t){e.$set(e.form,"range",t)},expression:"form.range"}},e._l(e.cycleList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),"hour"!==e.form.range&&"day"!==e.form.range?a("div",[a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.changeRange},model:{value:e.form.selectTime,callback:function(t){e.$set(e.form,"selectTime",t)},expression:"form.selectTime"}},e._l(e.selectTimeList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1):e._e(),"hour"!==e.form.range?a("div",[a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.changeRange},model:{value:e.form.hour,callback:function(t){e.$set(e.form,"hour",t)},expression:"form.hour"}},e._l(e.hourList,function(e){return a("el-option",{key:e,attrs:{label:e,value:e+""}})}),1)],1):e._e(),"hour"!==e.form.range?a("div",[e._v("时")]):e._e(),a("div",[a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.changeRange},model:{value:e.form.minute,callback:function(t){e.$set(e.form,"minute",t)},expression:"form.minute"}},e._l(e.minuteList,function(e){return a("el-option",{key:e,attrs:{label:e,value:e+""}})}),1)],1),a("div",[e._v("分")])])},o=[],l=(a("28a5"),a("768b")),c=(a("ac6a"),a("a745")),u=a.n(c);function f(e){if(u()(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}var d=a("774e"),h=a.n(d),m=a("c8bb"),p=a.n(m);function b(e){if(p()(Object(e))||"[object Arguments]"===Object.prototype.toString.call(e))return h()(e)}function v(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function y(e){return f(e)||b(e)||v()}a("6c7b");var g=[{label:"月",value:"month"},{label:"周",value:"week"},{label:"日",value:"day"},{label:"小时",value:"hour"}],j=[{label:"星期一",value:2},{label:"星期二",value:3},{label:"星期三",value:4},{label:"星期四",value:5},{label:"星期五",value:6},{label:"星期六",value:7},{label:"星期日",value:1}],S=Array(31).fill(1).map(function(e,t){return{value:t+1,label:"".concat(t+1,"号")}}),_=y(Array(24).keys()),k=y(Array(60).keys()).filter(function(e){return e%5===0}),L={cycleList:g,selectWeekList:j,selectMonthList:S,hourList:_,minuteList:k},x={props:{value:{type:String,default:null}},data:function(){return{form:{range:null,selectTime:null,hour:null,minute:null}}},computed:{selectTimeList:function(){return"week"===this.form.range?L.selectWeekList:"month"===this.form.range?L.selectMonthList:[]}},watch:{value:function(){this.transCycle()}},created:function(){this.cycleList=L.cycleList,this.hourList=L.hourList,this.minuteList=L.minuteList,this.transCycle()},methods:{changeRange:function(){var e=[],t=this.form,a=t.range,r=t.selectTime,i=t.hour,s=t.minute;e.push("0"),"day"===a?s&&i&&(e.push(s),e.push(i),e.push("*"),e.push("*"),e.push("?")):"hour"===a?s&&(e.push(s),e.push("*"),e.push("*"),e.push("*"),e.push("?")):"week"===a?s&&i&&r&&(e.push(s),e.push(i),e.push("?"),e.push("*"),e.push(r)):"month"===a&&s&&i&&r&&(e.push(s),e.push(i),e.push(r),e.push("*"),e.push("?")),this.$emit("input",1===e.length?null:e.join(" "))},transCycle:function(){if(this.value){var e=this.value.split(" "),t=Object(l["a"])(e,6),a=t[1],r=t[2],i=t[3],s=t[5];"?"!==s?(this.form.range="week",this.form.hour=r,this.form.minute=a,this.form.selectTime=+s):"*"!==i?(this.form.range="month",this.form.hour=r,this.form.minute=a,this.form.selectTime=+i):"*"===r?(this.form.range="hour",this.form.minute=a):(this.form.range="day",this.form.hour=r,this.form.minute=a)}}}},T=x,$=(a("f5d5"),a("2877")),w=Object($["a"])(T,n,o,!1,null,"bc9acd94",null),C=w.exports,I={components:{CronTime:C},props:{visible:{type:Boolean,default:!1},type:{type:String,default:"online"},obj:{type:Object,default:function(){return{}}}},data:function(){return{sqlPresto:"online"!==this.type,form:{dataSetId:this.obj.dataSetId||this.obj.id,dataSetType:this.obj.dataSetType||this.obj.type,refreshable:"presto"===this.obj.dataSourceType?1:0,cacheRefreshCron:null,cacheRefreshMode:"total"}}},computed:{title:function(){return"数据集-".concat(this.obj.name)}},created:function(){"line"===this.type&&(this.sqlPresto=!0),this.queryScheduleInfo(),this.rules={cacheRefreshCron:[{required:!0,message:"刷新时间必填",trigger:"change"}]}},methods:{queryScheduleInfo:function(){var e=this;Object(s["v"])({dataSetId:this.obj.dataSetId||this.obj.id,dataSetType:this.obj.dataSetType||this.obj.type}).then(function(t){if(t){var a=t.refreshable,r=t.cacheRefreshMode,i=t.cacheRefreshCron;e.form.refreshable=a,e.form.cacheRefreshMode=r||"total",e.form.cacheRefreshCron=i}})},line:function(){var e=this;"presto"!==this.obj.dataSourceType||this.sqlPresto?this.$refs.form.validate(function(t){return!!t&&("online"===e.type||"line"===e.type?Object(s["s"])(e.form).then(function(){e.$message({type:"success",message:"上线成功"}),e.$emit("close")}):Object(s["B"])(e.form).then(function(){e.$message({type:"success",message:"保存成功"}),e.$emit("close")}),!0)}):this.sqlPresto=!0}}},O=I,R=Object($["a"])(O,r,i,!1,null,null,null);t["a"]=R.exports},"20fd":function(e,t,a){"use strict";var r=a("d9f6"),i=a("aebd");e.exports=function(e,t,a){t in e?r.f(e,t,i(0,a)):e[t]=a}},"3eb5":function(e,t,a){"use strict";var r=a("fb8f"),i=a.n(r);i.a},"549b":function(e,t,a){"use strict";var r=a("d864"),i=a("63b6"),s=a("241e"),n=a("b0dc"),o=a("3702"),l=a("b447"),c=a("20fd"),u=a("7cd6");i(i.S+i.F*!a("4ee1")(function(e){Array.from(e)}),"Array",{from:function(e){var t,a,i,f,d=s(e),h="function"==typeof this?this:Array,m=arguments.length,p=m>1?arguments[1]:void 0,b=void 0!==p,v=0,y=u(d);if(b&&(p=r(p,m>2?arguments[2]:void 0,2)),void 0==y||h==Array&&o(y))for(t=l(d.length),a=new h(t);t>v;v++)c(a,v,b?p(d[v],v):d[v]);else for(f=y.call(d),a=new h;!(i=f.next()).done;v++)c(a,v,b?n(f,p,[i.value,v],!0):i.value);return a.length=v,a}})},"54a1":function(e,t,a){a("6c1c"),a("1654"),e.exports=a("95d5")},6350:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"bread-contaner"},[a("div",{staticClass:"flex"},[a("el-breadcrumb",{attrs:{separator:e.separator}},e._l(e.breadList,function(t,r){return a("el-breadcrumb-item",{key:r},[a("span",{on:{click:function(t){return e.breadClick(r)}}},[e._v(e._s(t.name))])])}),1),a("div",{staticClass:"left"},[e._t("left")],2)],1),a("div",{staticClass:"center"},[e._t("center")],2),a("div",{staticClass:"right"},[e._t("default")],2)])},i=[],s={props:{separator:{type:String,default:"/"},breadList:{type:Array,default:function(){return[{name:"demo"}]}}},methods:{breadClick:function(e){e!==this.breadList.length-1&&this.$emit("breadClick",this.breadList.slice(0,e+1))}}},n=s,o=(a("3eb5"),a("2877")),l=Object(o["a"])(n,r,i,!1,null,"f1dea4ce",null);t["a"]=l.exports},"6c7b":function(e,t,a){var r=a("5ca1");r(r.P,"Array",{fill:a("36bd")}),a("9c6c")("fill")},"774e":function(e,t,a){e.exports=a("d2d5")},"95d5":function(e,t,a){var r=a("40c3"),i=a("5168")("iterator"),s=a("481b");e.exports=a("584a").isIterable=function(e){var t=Object(e);return void 0!==t[i]||"@@iterator"in t||s.hasOwnProperty(r(t))}},a787:function(e,t,a){},b65c:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{style:{opacity:e.dialogVisible?0:1},attrs:{visible:e.visible,"close-on-click-modal":!1,"before-close":function(){e.$emit("close")},title:"保存数据集",width:"460px"},on:{"update:visible":function(t){e.visible=t}}},[e.dialogVisible?a("Dialog",{attrs:{visible:e.dialogVisible,obj:e.dialogObj,type:"online"},on:{close:function(t){e.dialogVisible=!1,e.goBackList()}}}):e._e(),a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"70px"}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{maxlength:20,"show-word-limit":!0,placeholder:"请输入名称，最多20个字符"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:"描述",prop:"description"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{type:"textarea",placeholder:"请输入描述信息"},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1),a("el-form-item",{attrs:{label:"项目"}},[e._v("\n      "+e._s(e.breadList[0]?e.breadList[0].name:"无")+"\n    ")]),a("el-form-item",{attrs:{label:"文件夹"}},[e._v("\n      "+e._s(e.dirName)+"\n    ")])],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.$emit("close")}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("保存")])],1)],1)},i=[],s=(a("ac6a"),a("7f7f"),a("b122")),n=a("0bad"),o={components:{Dialog:n["a"]},props:{visible:{type:Boolean,default:!1},params:{type:Object,default:function(){return{}}},breadList:{type:Array,default:function(){return[]}}},data:function(){return{dialogVisible:!1,dialogObj:{},form:{name:this.params.name,description:this.params.description}}},computed:{dirName:function(){var e=this.breadList.slice(1,this.breadList.length),t=0===e.length?"无":"";return e.forEach(function(e){t+="/".concat(e.name)}),t}},created:function(){this.rules={name:[{required:!0,message:"请输入名称",trigger:"blur"}],description:[{required:!0,message:"请输入描述",trigger:"blur"}]}},methods:{getParams:function(){return{dataSet:{id:this.params.id,projectId:this.params.projectId,directoryId:"".concat(this.params.directoryId)==="".concat(this.params.projectId)?-1:this.params.directoryId,dataSourceId:this.params.dataSourceObj.id,dataSourceType:this.params.dataSourceObj.type,name:this.form.name,description:this.form.description,esIndex:this.params.esIndex,esType:this.params.esType,baseSql:this.params.baseSql},columns:this.params.columns}},goBackList:function(){var e=this.params.directoryId,t=this.params.projectId;this.breadList.length>1&&(e=this.breadList[this.breadList.length-1].id,t=this.breadList[0].i),this.$router.push({name:"createSpaceIndex",params:{parentId:e,projectId:t,breadList:JSON.stringify(this.breadList.slice(0,this.breadList.length))}})},save:function(){var e=this;this.$refs.form.validate(function(t){if(t){if(e.params.paiConfig)return Object.assign(e.params,e.form),Object(s["z"])(e.params).then(function(t){e.$message({type:"success",message:"保存成功"}),e.dialogObj={dataSetId:t.dataSetId,dataSetType:t.dataSetType,dataSourceType:t.dataSourceType,name:e.form.name},e.dialogVisible=!0}),!0;var a=e.getParams();return Object(s["y"])(a).then(function(t){e.$message({type:"success",message:"保存成功"}),e.dialogObj={dataSetId:t.dataSetId,dataSetType:t.dataSetType,dataSourceType:t.dataSourceType,name:e.form.name},e.dialogVisible=!0}),!0}return!1})}}},l=o,c=a("2877"),u=Object(c["a"])(l,r,i,!1,null,null,null);t["a"]=u.exports},c8bb:function(e,t,a){e.exports=a("54a1")},d2d5:function(e,t,a){a("1654"),a("549b"),e.exports=a("584a").Array.from},f5d5:function(e,t,a){"use strict";var r=a("a787"),i=a.n(r);i.a},fb8f:function(e,t,a){}}]);
//# sourceMappingURL=chunk-1d913ad0.d4ed757c.js.map