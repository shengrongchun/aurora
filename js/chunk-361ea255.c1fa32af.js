(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-361ea255"],{"96db":function(e,t,a){"use strict";var n=a("ecec"),l=a.n(n);l.a},9988:function(e,t,a){"use strict";function n(e,t,a,n,l,o,i,r,s,c){"boolean"!==typeof i&&(s=r,r=i,i=!1);const d="function"===typeof a?a.options:a;let p;if(e&&e.render&&(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,l&&(d.functional=!0)),n&&(d._scopeId=n),o?(p=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,s(e)),e&&e._registeredComponents&&e._registeredComponents.add(o)},d._ssrRegister=p):t&&(p=i?function(e){t.call(this,c(e,this.$root.$options.shadowRoot))}:function(e){t.call(this,r(e))}),p)if(d.functional){const e=d.render;d.render=function(t,a){return p.call(a),e(t,a)}}else{const e=d.beforeCreate;d.beforeCreate=e?[].concat(e,p):[p]}return a}const l="undefined"!==typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());function o(e){return(e,t)=>s(e,t)}let i;const r={};function s(e,t){const a=l?t.media||"default":e,n=r[a]||(r[a]={ids:new Set,styles:[]});if(!n.ids.has(e)){n.ids.add(e);let a=t.source;if(t.map&&(a+="\n/*# sourceURL="+t.map.sources[0]+" */",a+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(t.map))))+" */"),n.element||(n.element=document.createElement("style"),n.element.type="text/css",t.media&&n.element.setAttribute("media",t.media),void 0===i&&(i=document.head||document.getElementsByTagName("head")[0]),i.appendChild(n.element)),"styleSheet"in n.element)n.styles.push(a),n.element.styleSheet.cssText=n.styles.filter(Boolean).join("\n");else{const e=n.ids.size-1,t=document.createTextNode(a),l=n.element.childNodes;l[e]&&n.element.removeChild(l[e]),l.length?n.element.insertBefore(t,l[e]):n.element.appendChild(t)}}}a.d(t,"a",function(){return p});const c={name:"Grid",props:{data:{type:Array,default:()=>[]},tableAttrs:{type:Object,default:()=>({})},isPagination:{type:Boolean,default:!0},paginationAttrs:{type:Object,default:()=>({})},isSelectRemember:{type:Boolean,default:!1},idKey:{type:String,default:"id"},isCellBorder:{type:Boolean,default:!0}},data:()=>({tableData:[],defaultTableAttrs:{height:"100%",border:!0},defaultPaginationAttrs:{pageSizes:[10,20,30,50],pageSize:20,currentPage:1,layout:"total, sizes, prev, pager, next, jumper",total:0},multipleSelectionAll:[],multipleSelection:[],tableEventList:{},paginationEventList:{}}),computed:{currentPaginationAttrs(){return Object.assign({},this.defaultPaginationAttrs,this.paginationAttrs)},currentTableAttrs(){return Object.assign({},this.defaultTableAttrs,this.tableAttrs)}},watch:{data(e){this.tableData=e,this.isSelectRemember?this.$nextTick(()=>{this.setSelectRow()}):this.multipleSelection=[]}},mounted(){this.$table=this.$refs.table,this.data.length&&(this.tableData=this.data)},created(){Object.keys(this.$listeners).forEach(e=>{"size-change"!==e&&"current-change"!==e&&"prev-click"!==e&&"next-click"!==e?this.tableEventList[e]=this.$listeners[e]:this.paginationEventList[e]=this.$listeners[e]})},methods:{handelSelectionChange(e){this.multipleSelection=e,this.isSelectRemember&&(this.changePageCoreRecordData(),this.$listeners["selection-change-remember"]&&this.$emit("selection-change-remember",this.multipleSelectionAll))},tableMethod(){},clearSelectionChange(){this.multipleSelection=[],this.multipleSelectionAll=[],this.$refs.table.clearSelection(),this.handelSelectionChange([])},setSelectRow(){if(!this.multipleSelectionAll||this.multipleSelectionAll.length<=0)return;const{idKey:e}=this,t=this.multipleSelectionAll.map(t=>t[e]);this.$refs.table.clearSelection(),t.length&&this.tableData.forEach((a,n)=>{t.indexOf(a[e])>=0&&this.$refs.table.toggleRowSelection(this.tableData[n],!0)})},changePageCoreRecordData(){const{idKey:e}=this;if(this.multipleSelectionAll.length<=0)return void(this.multipleSelectionAll=this.multipleSelection);const t=this.multipleSelectionAll.map(t=>t[e]),a=[];this.multipleSelection.forEach(n=>{a.push(n[e]),t.indexOf(n[e])<0&&this.multipleSelectionAll.push(n)}),this.tableData.reduce((t,n)=>(a.indexOf(n[e])<0&&t.push(n[e]),t),[]).forEach(a=>{t.indexOf(a)>=0&&this.multipleSelectionAll.forEach((t,n)=>{t[e]===a&&this.multipleSelectionAll.splice(n,1)})})}}};var d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"flex-box"},[a("el-table",e._g(e._b({ref:"table",class:{"no-cellborder":!e.isCellBorder},staticStyle:{width:"100%",height:"100%"},attrs:{data:e.data},on:{select:e.handelSelectionChange,"select-all":e.handelSelectionChange}},"el-table",e.currentTableAttrs,!1),e.tableEventList),[e._t("default")],2),e._v(" "),e.isPagination?a("el-pagination",e._g(e._b({staticStyle:{"margin-top":"15px","text-align":"right"}},"el-pagination",e.currentPaginationAttrs,!1),e.paginationEventList)):e._e()],1)};d._withStripped=!0;const p=n({render:d,staticRenderFns:[]},function(e){e&&e("data-v-6e00cccc_0",{source:".flex-box[data-v-6e00cccc] {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  width: 100%;\n}\n.el-table.no-cellborder[data-v-6e00cccc] td {\n  border: none;\n}\n",map:{version:3,sources:["index.vue"],names:[],mappings:"AAAA;EACE,aAAa;EACb,sBAAsB;EACtB,YAAY;EACZ,WAAW;AACb;AACA;EACE,YAAY;AACd",file:"index.vue",sourcesContent:[".flex-box {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  width: 100%;\n}\n.el-table.no-cellborder /deep/ td {\n  border: none;\n}\n"]},media:void 0})},c,"data-v-6e00cccc",!1,void 0,!1,o,void 0,void 0),u={name:"SelectIndex",props:{selectCount:{type:Number,default:0}},data:()=>({})};var h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"select-index-toolbar"},[a("i",{staticClass:"el-icon-warning"}),e._v(" "),a("span",{staticClass:"select-index"},[e._v("已选择 "+e._s(e.selectCount)+" 项")]),e._v(" "),e._t("default"),e._v(" "),a("div",{staticClass:"location-right"},[e._t("right")],2)],2)};h._withStripped=!0;const b=n({render:h,staticRenderFns:[]},function(e){e&&e("data-v-4a9109c0_0",{source:".select-index-toolbar[data-v-4a9109c0] {\n  font-size: 14px;\n  padding: 0px 14px;\n  margin-top: 10px;\n  margin-bottom: 10px;\n  background-color: #e2f6fe;\n  border-radius: 5px;\n  border: 1px solid #c6e2ff;\n}\n.select-index-toolbar .select-index[data-v-4a9109c0] {\n  margin: 0 20px 0 5px;\n  color: #666;\n}\n.select-index-toolbar i[data-v-4a9109c0] {\n  font-size: 18px;\n  position: relative;\n  top: 1px;\n  color: #409EFF;\n}\n.select-index-toolbar .location-right[data-v-4a9109c0] {\n  float: right;\n}\n",map:{version:3,sources:["index.vue"],names:[],mappings:"AAAA;EACE,eAAe;EACf,iBAAiB;EACjB,gBAAgB;EAChB,mBAAmB;EACnB,yBAAyB;EACzB,kBAAkB;EAClB,yBAAyB;AAC3B;AACA;EACE,oBAAoB;EACpB,WAAW;AACb;AACA;EACE,eAAe;EACf,kBAAkB;EAClB,QAAQ;EACR,cAAc;AAChB;AACA;EACE,YAAY;AACd",file:"index.vue",sourcesContent:[".select-index-toolbar {\n  font-size: 14px;\n  padding: 0px 14px;\n  margin-top: 10px;\n  margin-bottom: 10px;\n  background-color: #e2f6fe;\n  border-radius: 5px;\n  border: 1px solid #c6e2ff;\n}\n.select-index-toolbar .select-index {\n  margin: 0 20px 0 5px;\n  color: #666;\n}\n.select-index-toolbar i {\n  font-size: 18px;\n  position: relative;\n  top: 1px;\n  color: #409EFF;\n}\n.select-index-toolbar .location-right {\n  float: right;\n}\n"]},media:void 0})},u,"data-v-4a9109c0",!1,void 0,!1,o,void 0,void 0),m=[p,b];function f(e){m.forEach(t=>{e.component(t.name,t)})}"undefined"!=typeof window&&window.Vue&&f(window.Vue)},b1e8:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main-container"},[a("Breadcrumb",{attrs:{"bread-list":e.breadList},on:{breadClick:e.breadClick}},["新建ES数据集"!==e.breadList[e.breadList.length-1].name?a("el-button",{attrs:{slot:"left",type:"text"},on:{click:function(t){e.look=!e.look}},slot:"left"},[e._v(e._s(e.look?"查看模式":"编辑模式"))]):e._e(),a("el-button",{attrs:{disabled:e.look,type:"primary"},on:{click:e.saveData}},[e._v("保存数据集")])],1),a("el-form",{ref:"form",staticClass:"header",attrs:{inline:!0,model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{label:"数据源",prop:"dataSourceObj"}},[a("el-select",{attrs:{disabled:e.look,placeholder:"请选择数据源"},model:{value:e.form.dataSourceObj,callback:function(t){e.$set(e.form,"dataSourceObj",t)},expression:"form.dataSourceObj"}},e._l(e.sourceList,function(e,t){return a("el-option",{key:t,attrs:{value:e,label:e.name}})}),1)],1),a("el-form-item",{attrs:{label:"索引名",prop:"esIndex"}},[a("el-input",{attrs:{disabled:e.look,placeholder:"请输入索引名"},model:{value:e.form.esIndex,callback:function(t){e.$set(e.form,"esIndex",t)},expression:"form.esIndex"}})],1),a("el-form-item",{attrs:{label:"type",prop:"esType"}},[a("el-input",{attrs:{disabled:e.look,placeholder:"请输入type"},model:{value:e.form.esType,callback:function(t){e.$set(e.form,"esType",t)},expression:"form.esType"}})],1),a("el-button",{attrs:{disabled:e.look,type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.form.columns.push({})}}},[e._v("新建")])],1),a("Grid",{attrs:{tableAttrs:{border:!1},isCellborder:!1,isPagination:!1,data:e.form.columns}},[a("el-table-column",{attrs:{label:"序号","header-align":"center",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.$index+1))])]}}])}),e._l(e.tableList,function(t){return["name"===t.prop?[a("el-table-column",{key:t.prop,attrs:{prop:t.prop,label:t.label,width:t.width,sortable:t.sortable,"show-overflow-tooltip":"","header-align":"center",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{disabled:e.look,placeholder:"请输入字段名"},model:{value:t.row.name,callback:function(a){e.$set(t.row,"name",a)},expression:"scope.row.name"}})]}}],null,!0)})]:"label"===t.prop?[a("el-table-column",{key:t.prop,attrs:{prop:t.prop,label:t.label,width:t.width,sortable:t.sortable,"show-overflow-tooltip":"","header-align":"center",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{disabled:e.look,placeholder:"请输入显示名称"},model:{value:t.row.label,callback:function(a){e.$set(t.row,"label",a)},expression:"scope.row.label"}})]}}],null,!0)})]:"dataType"===t.prop?[a("el-table-column",{key:t.prop,attrs:{prop:t.prop,label:t.label,width:t.width,sortable:t.sortable,"show-overflow-tooltip":"","header-align":"center",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{attrs:{disabled:e.look,placeholder:"请选择字段类型"},model:{value:t.row.dataType,callback:function(a){e.$set(t.row,"dataType",a)},expression:"scope.row.dataType"}},[a("el-option",{attrs:{label:"整型数值",value:"integer"}}),a("el-option",{attrs:{label:"浮点数值",value:"double"}}),a("el-option",{attrs:{label:"字符串类型",value:"string"}}),a("el-option",{attrs:{label:"时间类型",value:"time"}})],1)]}}],null,!0)})]:"type"===t.prop?[a("el-table-column",{key:t.prop,attrs:{prop:t.prop,label:t.label,width:t.width,sortable:t.sortable,"show-overflow-tooltip":"","header-align":"center",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{attrs:{disabled:e.look,placeholder:"请选择字段种类"},model:{value:t.row.type,callback:function(a){e.$set(t.row,"type",a)},expression:"scope.row.type"}},[a("el-option",{attrs:{label:"维度",value:"dimension"}}),a("el-option",{attrs:{label:"指标",value:"metric"}})],1)]}}],null,!0)})]:e._e()]}),a("el-table-column",{attrs:{label:"操作","header-align":"center",align:"center",width:"100px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"el-table-edit"},[a("el-button",{class:{disabled:e.look},attrs:{disabled:e.look,type:"text"},on:{click:function(a){return e.deleteM(t.$index)}}},[a("i",{staticClass:"iconfont icon-shanchu-copy-copy"})])],1)]}}])})],2),e.dialogVisible?a("Dialog",{attrs:{visible:e.dialogVisible,params:e.form,breadList:e.$route.params.breadList},on:{close:function(t){e.dialogVisible=!1}}}):e._e()],1)},l=[],o=(a("7f7f"),a("b122")),i=a("6350"),r=a("9988"),s=a("b65c"),c=[{label:"字段名 ",prop:"name"},{label:"显示名称",prop:"label"},{label:"字段类型",prop:"dataType"},{label:"字段种类",prop:"type"},{label:"格式",prop:"format"}],d={tableList:c},p={components:{Grid:r["a"],Dialog:s["a"],Breadcrumb:i["a"]},data:function(){return{dialogVisible:!1,sourceList:[],look:!!this.$route.params.look,form:{name:this.res.dataSet.name,description:this.res.dataSet.description,id:this.res.dataSet.id,projectId:this.$route.params.projectId,directoryId:this.$route.params.parentId,dataSourceObj:null,esIndex:this.res.dataSet.esIndex,esType:this.res.dataSet.esType,columns:this.res.columns||[]}}},computed:{breadList:function(){var e=(this.$route.params.breadList||[]).concat([]);return this.res.columns.length>0?e.push({name:"".concat(this.look?"查看":"编辑"," ES - ").concat(this.form.name," 数据集")}):e.push({name:"新建ES数据集"}),e}},beforeCreate:function(){this.res=this.$route.params.res||{columns:[],dataSet:{}},this.tableList=d.tableList,this.rules={dataSourceObj:[{required:!0,message:"请选择数据源",trigger:"blur"}],esIndex:[{required:!0,message:"请输入索引值",trigger:"blur"}],esType:[{required:!0,message:"请输入索引类型",trigger:"blur"}]}},created:function(){this.getTypeSource()},methods:{getTypeSource:function(){var e=this;Object(o["l"])({projectId:this.$route.params.projectId,dataSourceType:this.$route.params.type}).then(function(t){if(e.sourceList=t,e.res.columns.length>0)for(var a=e.res.dataSet,n=0,l=t.length;n<l;n+=1)if(t[n].id===a.dataSourceId&&t[n].type===a.dataSourceType)return void(e.form.dataSourceObj=t[n])})},deleteM:function(e){this.form.columns.splice(e,1)},breadClick:function(e){var t=e.length;this.$router.push({name:"createSpaceIndex",params:{parentId:t>1?e[t-1].id:-1,projectId:this.$route.params.projectId||-1,breadList:JSON.stringify(e)}})},saveData:function(){var e=this,t=this.form.columns.length;if(t<1)this.$message.warning("请新建");else{for(var a=0;a<t;a+=1){var n=this.form.columns[a];if(!n.name||!n.label||!n.dataType||!n.type)return void this.$message.warning("第 ".concat(a+1," 行有未填项"))}this.$refs.form.validate(function(t){return!!t&&(e.dialogVisible=!0,!0)})}}}},u=p,h=(a("96db"),a("2877")),b=Object(h["a"])(u,n,l,!1,null,"469899ab",null);t["default"]=b.exports},ecec:function(e,t,a){}}]);
//# sourceMappingURL=chunk-361ea255.c1fa32af.js.map